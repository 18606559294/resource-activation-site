!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const e={},t=function(t,a,s){let i=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const t=document.querySelector("meta[property=csp-nonce]"),s=(null==t?void 0:t.nonce)||(null==t?void 0:t.getAttribute("nonce"));i=Promise.allSettled(a.map((t=>{if((t=function(e){return"/resource-activation-site/"+e}(t))in e)return;e[t]=!0;const a=t.endsWith(".css"),i=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${i}`))return;const n=document.createElement("link");return n.rel=a?"stylesheet":"modulepreload",a||(n.as="script"),n.crossOrigin="",n.href=t,s&&n.setAttribute("nonce",s),document.head.appendChild(n),a?new Promise(((e,a)=>{n.addEventListener("load",e),n.addEventListener("error",(()=>a(new Error(`Unable to preload CSS for ${t}`))))})):void 0})))}function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return i.then((e=>{for(const t of e||[])"rejected"===t.status&&n(t.reason);return t().catch(n)}))};class a{constructor(e){if(!e)throw new Error("API密钥不能为空");this.apiKey=e,this.apiEndpoint="https://api.deepseek.com/v1/chat/completions",this.model="deepseek-chat"}async sendChatRequest(e){var t;if(!e||!Array.isArray(e)||0===e.length)throw new Error("消息不能为空");try{const a=await fetch(this.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify({model:this.model,messages:e,temperature:.7,max_tokens:1e3})});if(!a.ok){const e=await a.json().catch((()=>({})));throw new Error(`API请求失败: ${a.status} ${(null==(t=e.error)?void 0:t.message)||a.statusText}`)}return await a.json()}catch(a){throw console.error("DeepSeek API请求失败:",a),a}}async chat(e,t=[]){if(!e)throw new Error("用户消息不能为空");const a=[...t,{role:"user",content:e}];try{const e=await this.sendChatRequest(a);if(e.choices&&e.choices.length>0)return e.choices[0].message.content;throw new Error("API响应格式不正确")}catch(s){throw console.error("聊天请求失败:",s),s}}setApiKey(e){if(!e)throw new Error("API密钥不能为空");this.apiKey=e}setModel(e){if(!e)throw new Error("模型名称不能为空");this.model=e}}class s{static async encrypt(e,t){try{const a=await this._getKeyMaterial(t),s=await this._deriveKey(a),i=crypto.getRandomValues(new Uint8Array(12)),n=(new TextEncoder).encode(e),o=await crypto.subtle.encrypt({name:"AES-GCM",iv:i},s,n),r=new Uint8Array(i.length+o.byteLength);return r.set(i),r.set(new Uint8Array(o),i.length),btoa(String.fromCharCode.apply(null,r))}catch(a){throw console.error("加密失败:",a),new Error("加密操作失败")}}static async decrypt(e,t){try{const a=new Uint8Array(atob(e).split("").map((e=>e.charCodeAt(0)))),s=a.slice(0,12),i=a.slice(12),n=await this._getKeyMaterial(t),o=await this._deriveKey(n),r=await crypto.subtle.decrypt({name:"AES-GCM",iv:s},o,i);return(new TextDecoder).decode(r)}catch(a){throw console.error("解密失败:",a),new Error("解密操作失败")}}static async _getKeyMaterial(e){const t=new TextEncoder;return await crypto.subtle.importKey("raw",t.encode(e),{name:"PBKDF2"},!1,["deriveBits","deriveKey"])}static async _deriveKey(e){const t=(new TextEncoder).encode("resource-activation-site-salt");return await crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}static generateSecurePassword(e=16){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()",a=new Uint8Array(e);crypto.getRandomValues(a);let s="";for(let i=0;i<e;i++)s+=t[a[i]%72];return s}}const i={en:{title:"Resource Collection and Activation Tools","card1.title":"Active Management of Activation Tools","card1.description":"This position provides management and updates for activation tools, responding promptly to user needs for updated resources, ensuring compatibility across different Windows versions.","card2.title":"User Feedback and Problem Resolution","card2.description":"Users often leave comments about activation issues and other concerns. Site management provides immediate comprehensive solutions, creating an interactive and supportive community.","card3.title":"Resource Security Considerations","card3.description":"The platform emphasizes security, ensuring all shared resources are tested for viruses and malware, and alerts users to potential conflicts with built-in security software.","card4.title":"Dynamic Resource Links and User Accessibility","card4.description":"Users can easily browse the resource platform through public links and quickly access updated resources, enhancing user experience and convenience.","feedback.title":"Feedback and Solutions","feedback.header":"Problem Feedback","feedback.placeholder":"Please describe the issue you encountered...","feedback.submit":"Submit Feedback","feedback.history":"History Issues","feedback.back":"Back to Home","feedback.recommended":"Recommended Tools","feedback.status.success":"Feedback submitted successfully!","feedback.status.error":"Error submitting feedback. Please try again.","security.title":"Internet Security Tips","security.header":"Internet Security Tips","security.back":"Back to Home","security.password.title":"Password Security","security.password.description":"Learn how to create and manage strong passwords to protect your accounts.","security.password.modal.title":"Detailed Password Security Guide","security.password.modal.content":"\n            <h3>Password Best Practices:</h3>\n            <ul>\n                <li>Use at least 12 characters</li>\n                <li>Include numbers, symbols, and both upper and lowercase letters</li>\n                <li>Avoid using personal information</li>\n                <li>Don't use keyboard patterns or common phrases</li>\n                <li>Use different passwords for different accounts</li>\n                <li>Change passwords regularly (every 3 months recommended)</li>\n                <li>Use a password manager</li>\n                <li>Enable two-factor authentication when available</li>\n            </ul>\n        ","security.antivirus.title":"Antivirus Protection","security.antivirus.description":"Learn how to protect your devices from viruses and malware.","security.antivirus.modal.title":"Antivirus Protection Guide","security.antivirus.modal.content":"\n            <h3>Antivirus Protection Tips:</h3>\n            <ul>\n                <li>Install reputable antivirus software</li>\n                <li>Keep your antivirus updated</li>\n                <li>Run regular system scans</li>\n                <li>Be careful when downloading files</li>\n                <li>Don't open suspicious email attachments</li>\n                <li>Keep your operating system updated</li>\n                <li>Use a firewall</li>\n                <li>Back up important files regularly</li>\n            </ul>\n        ","security.privacy.title":"Privacy Protection","security.privacy.description":"Important tips for protecting your personal information and online privacy.","security.privacy.modal.title":"Privacy Protection Guide","security.privacy.modal.content":"\n            <h3>Privacy Protection Measures:</h3>\n            <ul>\n                <li>Be careful what you share on social media</li>\n                <li>Regularly check privacy settings</li>\n                <li>Use a VPN when necessary</li>\n                <li>Clear browsing history and cookies regularly</li>\n                <li>Use private browsing mode</li>\n                <li>Disable unnecessary location services</li>\n                <li>Be careful with third-party app permissions</li>\n                <li>Monitor account login history</li>\n            </ul>\n        ","security.update.title":"System Updates","security.update.description":"Keep your system and software updated for optimal security.","security.update.modal.title":"System Update Guide","security.update.modal.content":"\n            <h3>Update Guidelines:</h3>\n            <ul>\n                <li>Enable automatic updates</li>\n                <li>Check for updates regularly</li>\n                <li>Update all software, not just the operating system</li>\n                <li>Back up your data before major updates</li>\n                <li>Only download updates from official sources</li>\n            </ul>\n        ","status.title":"System Status Monitor","status.server":"Server Status","status.checking":"Checking...","status.connected":"Connected Clients: ","status.uptime":"Uptime: ","status.updates":"Recent Updates","status.online":"Online","status.offline":"Offline","deepseek.logs.initialized":"DeepSeek chat widget initialized","deepseek.logs.initFailed":"Failed to initialize DeepSeek chat widget:","deepseek.errors.initFailed":"Chat system initialization failed, please try again later","deepseek.openChat":"Open customer service chat","deepseek.closeChat":"Close chat window","deepseek.title":"Online Customer Service"},zh:{title:"资源收集和激活工具更新","card1.title":"激活工具的主动管理","card1.description":"该岗位提供管理和更新激活工具，及时响应用户对更新资源的需求，确保不同 Windows 版本的兼容可访问性。","card2.title":"用户反馈和问题解决","card2.description":"用户经常会留下有关激活问题和其他疑虑的评论，网站管理会立即提供完善的解决方案，从而创建一个互动且相互支持的社区。","card3.title":"资源安全注意事项","card3.description":"该平台强调安全性，确保所有共享资源都经过病毒和恶意软件测试，并提醒用户注意可能干扰内置安全软件的潜在冲突。","card4.title":"动态资源链接和用户可访问性","card4.description":"用户可以通过公共链接轻松浏览资源平台，快速访问已更新的资源，从而增强用户体验和便利性。","feedback.title":"问题反馈与解决","feedback.header":"问题反馈","feedback.placeholder":"请描述您遇到的问题...","feedback.submit":"提交反馈","feedback.history":"历史问题","feedback.back":"返回主页","feedback.recommended":"推荐工具","feedback.status.success":"反馈提交成功！","feedback.status.error":"提交反馈失败，请重试。","security.title":"互联网安全提示","security.header":"互联网安全提示","security.back":"返回主页","security.password.title":"密码安全","security.password.description":"了解如何创建和管理强密码来保护您的账户。","security.password.modal.title":"密码安全详细指南","security.password.modal.content":"\n            <h3>创建强密码的原则：</h3>\n            <ul>\n                <li>使用至少12个字符的密码</li>\n                <li>混合使用大小写字母、数字和特殊符号</li>\n                <li>避免使用个人信息（生日、姓名等）</li>\n                <li>不要使用键盘规律或常见词组</li>\n                <li>为不同账户使用不同密码</li>\n                <li>定期更换密码（建议每3个月）</li>\n                <li>使用密码管理器</li>\n                <li>开启双因素认证（如果可用）</li>\n            </ul>\n        ","security.antivirus.title":"病毒防护","security.antivirus.description":"了解如何保护您的设备免受病毒和恶意软件的侵害。","security.antivirus.modal.title":"病毒防护指南","security.antivirus.modal.content":"\n            <h3>病毒防护要点：</h3>\n            <ul>\n                <li>安装可靠的防病毒软件</li>\n                <li>保持防病毒软件更新</li>\n                <li>定期进行系统扫描</li>\n                <li>下载文件时要谨慎</li>\n                <li>不要打开可疑的邮件附件</li>\n                <li>及时更新操作系统</li>\n                <li>使用防火墙</li>\n                <li>定期备份重要文件</li>\n            </ul>\n        ","security.privacy.title":"隐私保护","security.privacy.description":"保护您的个人信息和在线隐私的重要提示。","security.privacy.modal.title":"隐私保护指南","security.privacy.modal.content":"\n            <h3>保护个人隐私的措施：</h3>\n            <ul>\n                <li>谨慎分享个人信息在社交媒体</li>\n                <li>定期检查隐私设置</li>\n                <li>必要时使用VPN</li>\n                <li>定期清理浏览记录和Cookie</li>\n                <li>使用隐私浏览模式</li>\n                <li>关闭不必要的位置服务</li>\n                <li>谨慎使用第三方应用授权</li>\n                <li>监控账户登录记录</li>\n            </ul>\n        ","security.update.title":"系统更新","security.update.description":"保持系统和软件更新以确保最佳安全性。","security.update.modal.title":"系统更新指南","security.update.modal.content":"\n            <h3>更新指南：</h3>\n            <ul>\n                <li>启用自动更新</li>\n                <li>定期检查更新</li>\n                <li>更新所有软件，不仅是操作系统</li>\n                <li>重要更新前备份数据</li>\n                <li>仅从官方源下载更新</li>\n            </ul>\n        ","status.title":"系统状态监控","status.server":"服务器状态","status.checking":"检查中...","status.connected":"已连接客户端: ","status.uptime":"运行时间: ","status.updates":"最近更新","status.online":"在线","status.offline":"离线","deepseek.logs.initialized":"DeepSeek客服聊天窗口已加载","deepseek.logs.initFailed":"初始化DeepSeek客服聊天窗口失败:","deepseek.errors.initFailed":"客服系统初始化失败，请稍后再试","deepseek.openChat":"打开客服聊天","deepseek.closeChat":"关闭聊天窗口","deepseek.title":"在线客服"}};let n=localStorage.getItem("language")||((navigator.language||navigator.userLanguage).startsWith("zh")?"zh":"en");function o(){document.documentElement.lang=n;document.querySelectorAll("[data-i18n]").forEach((e=>{const t=e.getAttribute("data-i18n");i[n][t]&&(e.textContent=i[n][t])}));document.querySelectorAll("[data-i18n-placeholder]").forEach((e=>{const t=e.getAttribute("data-i18n-placeholder");i[n][t]&&(e.placeholder=i[n][t])}));document.querySelectorAll("[data-i18n-html]").forEach((e=>{const t=e.getAttribute("data-i18n-html");i[n][t]&&(e.innerHTML=i[n][t])}))}const r={translations:i,updateContent:o,switchLanguage:function(e){n=e,localStorage.setItem("language",e),o()},currentLanguage:n,t:function(e,t){return i[n][e]||t||e}};class l{constructor(){this.apiKey=null,this.api=null,this.chatHistory=[],this.isOpen=!1,this.isInitialized=!1,this.encryptionKey=null,this.createWidgetElements(),this.initialize()}async initialize(){var e;try{const n=null==(e=window.ENV)?void 0:e.DEEPSEEK_API_KEY_ENCRYPTED;if(n){const e=await t((()=>import("./api-keys-BI2k6KOc.js")),[]);this.apiKey=await s.decrypt(n,e.default.ENCRYPTION_KEY)}else{const e=await t((()=>import("./api-keys-BI2k6KOc.js")),[]);try{const{DeepSeekIntegration:a}=await t((async()=>{const{DeepSeekIntegration:e}=await import("./deepseek-integration-DDBlkned.js").then((e=>e.d));return{DeepSeekIntegration:e}}),[]);new a;await new Promise((e=>setTimeout(e,500))),this.apiKey=await s.decrypt(window.ENV.DEEPSEEK_API_KEY_ENCRYPTED,e.default.ENCRYPTION_KEY)}catch(i){throw console.error("Failed to get API key from DeepSeekIntegration:",i),new Error("API key initialization failed")}}this.api=new a(this.apiKey),this.isInitialized=!0,console.log(r.t("deepseek.logs.initialized","DeepSeek 客服聊天窗口已初始化"))}catch(i){console.error(r.t("deepseek.logs.initFailed","初始化DeepSeek客服聊天窗口失败:"),i),this.showError(r.t("deepseek.errors.initFailed","客服系统初始化失败，请稍后再试"))}}createWidgetElements(){this.container=document.createElement("div"),this.container.className="deepseek-chat-widget",this.container.style.left="20px",this.container.style.top="100px",this.container.style.right="auto",this.container.style.bottom="auto",this.chatButton=document.createElement("button"),this.chatButton.className="deepseek-chat-button",this.chatButton.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>',this.chatButton.setAttribute("aria-label",r.t("deepseek.openChat","打开客服聊天")),this.chatWindow=document.createElement("div"),this.chatWindow.className="deepseek-chat-window",this.chatWindow.style.display="none";const e=document.createElement("div");e.className="deepseek-chat-header";const t=document.createElement("h3");t.textContent=r.t("deepseek.title","在线客服");const a=document.createElement("button");a.className="deepseek-chat-close",a.innerHTML="&times;",a.setAttribute("aria-label",r.t("deepseek.closeChat","关闭聊天窗口")),e.appendChild(t),e.appendChild(a),this.messagesContainer=document.createElement("div"),this.messagesContainer.className="deepseek-chat-messages";const s=document.createElement("div");s.className="deepseek-chat-message assistant",s.innerHTML=r.t("deepseek.welcomeMessage","您好！我是AI客服助手，很高兴为您服务。<br><br>您可以咨询以下问题：<br>1. 产品功能与使用方法<br>2. 账户激活与订阅问题<br>3. 技术支持与故障排除<br>4. 付款与发票相关<br><br>请告诉我您需要什么帮助？"),this.messagesContainer.appendChild(s);const i=document.createElement("div");i.className="deepseek-chat-input-area",this.messageInput=document.createElement("textarea"),this.messageInput.className="deepseek-chat-input",this.messageInput.placeholder=r.t("deepseek.inputPlaceholder","请输入您的问题..."),this.messageInput.rows=1;const n=document.createElement("button");n.className="deepseek-chat-send",n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>',n.setAttribute("aria-label",r.t("deepseek.sendMessage","发送消息")),i.appendChild(this.messageInput),i.appendChild(n),this.chatWindow.appendChild(e),this.chatWindow.appendChild(this.messagesContainer),this.chatWindow.appendChild(i),this.container.appendChild(this.chatButton),this.container.appendChild(this.chatWindow),document.body.appendChild(this.container),this.chatButton.addEventListener("click",(()=>this.toggleChat())),a.addEventListener("click",(()=>this.toggleChat(!1))),n.addEventListener("click",(()=>this.sendMessage())),this.messageInput.addEventListener("keypress",(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),this.sendMessage())})),this.messageInput.addEventListener("input",(()=>{this.messageInput.style.height="auto",this.messageInput.style.height=this.messageInput.scrollHeight+"px"}))}toggleChat(e){this.isOpen=void 0!==e?e:!this.isOpen,this.chatWindow.style.display=this.isOpen?"flex":"none",this.isOpen&&(this.messageInput.focus(),this.scrollToBottom())}async sendMessage(){const e=this.messageInput.value.trim();if(!e)return;if(!this.isInitialized)return void this.showError(r.t("deepseek.errors.initializing","客服系统正在初始化，请稍后再试"));this.messageInput.value="",this.messageInput.style.height="auto",this.addMessage(e,"user");const t=this.showLoading();try{const a=await this.api.chat(e,this.chatHistory);this.removeLoading(t),this.addMessage(a,"assistant"),this.chatHistory.push({role:"user",content:e}),this.chatHistory.push({role:"assistant",content:a}),this.chatHistory.length>10&&(this.chatHistory=this.chatHistory.slice(this.chatHistory.length-10))}catch(a){console.error("发送消息失败:",a),this.removeLoading(t),this.showError(r.t("deepseek.errors.sendFailed","消息发送失败，请稍后再试"))}}addMessage(e,t){const a=document.createElement("div");a.className=`deepseek-chat-message ${t}`,"assistant"===t&&(e=e.replace(/\n/g,"<br>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank">$1</a>')),a.innerHTML=e,this.messagesContainer.appendChild(a),this.scrollToBottom()}showLoading(){const e="loading-"+Date.now(),t=document.createElement("div");return t.className="deepseek-chat-message assistant loading",t.id=e,t.innerHTML='<div class="typing-indicator"><span></span><span></span><span></span></div>',this.messagesContainer.appendChild(t),this.scrollToBottom(),e}removeLoading(e){const t=document.getElementById(e);t&&t.remove()}showError(e){const t=document.createElement("div");t.className="deepseek-chat-message error",t.textContent=e,this.messagesContainer.appendChild(t),this.scrollToBottom(),setTimeout((()=>{t.classList.add("fade-out"),setTimeout((()=>t.remove()),500)}),5e3)}scrollToBottom(){this.messagesContainer.scrollTop=this.messagesContainer.scrollHeight}}class c{constructor(){if(window.i18nManager instanceof c)return console.log("I18nManager已经初始化，返回现有实例"),window.i18nManager;this.currentLanguage="zh",this.translations={},this.observers=new Set,this.fallbackLanguage="zh",this.loadedLanguages=new Set,this.dateTimeFormatter=new Intl.DateTimeFormat,this.isInitializing=!1,this.initializationPromise=null,this.showDefaultContent(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>this.init())):this.init(),setTimeout((()=>{document.documentElement.hasAttribute("data-i18n-loading")&&(console.warn("国际化初始化超时，使用默认显示"),this.handleInitTimeout())}),5e3),window.i18nManager=this}showDefaultContent(){document.querySelectorAll("[data-i18n]").forEach((e=>{const t=e.getAttribute("data-i18n-default");t&&("INPUT"===e.tagName||"TEXTAREA"===e.tagName?e.placeholder=t:e.textContent=t,e.style.visibility="visible")}))}handleInitTimeout(){this.fallbackToDefault(),document.documentElement.removeAttribute("data-i18n-loading"),document.querySelectorAll("[data-i18n]").forEach((e=>{e.style.visibility="visible"}))}async init(){return this.isInitializing||(this.isInitializing=!0,document.documentElement.setAttribute("data-i18n-loading","true"),this.initializationPromise=(async()=>{try{const e=localStorage.getItem("preferredLanguage"),t=this.getSystemLanguage(),a=e||t;if(await Promise.all([this.loadLanguage(a).catch((e=>(console.warn(`${a}语言包加载失败:`,e),null))),this.loadLanguage(this.fallbackLanguage).catch((e=>(console.warn(`${this.fallbackLanguage}语言包加载失败:`,e),null)))]),0===this.loadedLanguages.size)throw new Error("所有语言包加载失败");const s=this.loadedLanguages.has(a)?a:this.fallbackLanguage;await this.setLanguage(s),this.initSystemLanguageDetection(),console.log("I18n initialized:",{current:this.currentLanguage,loaded:Array.from(this.loadedLanguages)})}catch(e){console.error("Failed to initialize i18n:",e),this.fallbackToDefault()}finally{this.isInitializing=!1,document.documentElement.removeAttribute("data-i18n-loading"),document.querySelectorAll("[data-i18n]").forEach((e=>{e.style.visibility="visible"}))}})()),this.initializationPromise}getSystemLanguage(){return navigator.language.toLowerCase().startsWith("zh")?"zh":"en"}initSystemLanguageDetection(){void 0!==window.languagechange&&window.addEventListener("languagechange",(()=>{const e=this.getSystemLanguage();localStorage.getItem("preferredLanguage")||this.setLanguage(e)}))}async loadLanguage(e){if(this.loadedLanguages.has(e))return;for(let a=1;a<=3;a++)try{const t=await fetch(`./locales/${e}.json`);if(!t.ok){console.warn(`尝试备用路径加载语言包: ${e}`);const a=await fetch(`../locales/${e}.json`);if(!a.ok)throw new Error(`HTTP error! status: ${t.status}, backup status: ${a.status}`);const s=await a.json();return this.translations[e]=s,this.loadedLanguages.add(e),void console.log(`成功从备用路径加载语言包: ${e}`)}const a=await t.json();return this.translations[e]=a,this.loadedLanguages.add(e),void console.log(`成功加载语言包: ${e}`)}catch(t){if(console.warn(`Failed to load language pack: ${e} (Attempt ${a}/3)`,t),3===a)throw t;await new Promise((e=>setTimeout(e,1e3)))}}async setLanguage(e){try{this.loadedLanguages.has(e)||await this.loadLanguage(e),this.currentLanguage=e,localStorage.setItem("preferredLanguage",e),document.documentElement.setAttribute("lang",e),this.updateAllTranslations(),this.notifyObservers()}catch(t){console.error(`Failed to set language: ${e}`,t),this.fallbackToDefault()}}updateAllTranslations(){document.querySelectorAll("[data-i18n]").forEach((e=>{const t=e.getAttribute("data-i18n"),a=e.getAttribute("data-i18n-default"),s=this.translate(t,a);e.textContent=s}));document.querySelectorAll("[data-i18n-placeholder]").forEach((e=>{const t=e.getAttribute("data-i18n-placeholder"),a=e.getAttribute("data-i18n-default-placeholder"),s=this.translate(t,a);e.setAttribute("placeholder",s)}))}translate(e,t){const a=this.translations[this.currentLanguage];if(!a)return t||e;const s=e.split(".");let i=a;for(const n of s){if(!i||"object"!=typeof i)return t||e;i=i[n]}return i||t||e}addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}notifyObservers(){this.observers.forEach((e=>e(this.currentLanguage)))}handleInitTimeout(){this.fallbackToDefault(),document.documentElement.removeAttribute("data-i18n-loading")}fallbackToDefault(){this.currentLanguage=this.fallbackLanguage,document.documentElement.setAttribute("lang",this.fallbackLanguage);document.querySelectorAll("[data-i18n]").forEach((e=>{const t=e.getAttribute("data-i18n-default");t&&(e.textContent=t)}))}}const d=new c,u=Object.freeze(Object.defineProperty({__proto__:null,I18nManager:c,default:d},Symbol.toStringTag,{value:"Module"}));const h=new class{constructor(){this.toastContainer=this.createToastContainer(),this.loadingOverlay=this.createLoadingOverlay(),document.body.appendChild(this.toastContainer),document.body.appendChild(this.loadingOverlay)}createToastContainer(){const e=document.createElement("div");return e.className="toast-container",e}createLoadingOverlay(){const e=document.createElement("div");return e.className="loading-overlay",e.innerHTML='\n      <div class="loading-spinner">\n        <div class="spinner"></div>\n        <div class="loading-text">加载中...</div>\n      </div>\n    ',e.style.display="none",e}showToast(e,t="info",a=3e3){const s=document.createElement("div");s.className=`toast toast-${t}`,s.innerHTML=`\n      <div class="toast-icon">${this.getToastIcon(t)}</div>\n      <div class="toast-message">${e}</div>\n    `,this.toastContainer.appendChild(s),requestAnimationFrame((()=>{s.classList.add("show")})),setTimeout((()=>{s.classList.remove("show"),setTimeout((()=>{this.toastContainer.removeChild(s)}),300)}),a)}getToastIcon(e){const t={success:"<svg>...</svg>",error:"<svg>...</svg>",warning:"<svg>...</svg>",info:"<svg>...</svg>"};return t[e]||t.info}showLoading(e="加载中..."){this.loadingOverlay.querySelector(".loading-text").textContent=e,this.loadingOverlay.style.display="flex",document.body.style.overflow="hidden"}hideLoading(){this.loadingOverlay.style.display="none",document.body.style.overflow=""}async showConfirm(e){return new Promise((t=>{const a=document.createElement("div");a.className="dialog-overlay",a.innerHTML=`\n        <div class="dialog">\n          <h3 class="dialog-title">${e.title||"确认"}</h3>\n          <div class="dialog-content">${e.message}</div>\n          <div class="dialog-buttons">\n            <button class="btn btn-secondary" data-action="cancel">\n              ${e.cancelText||"取消"}\n            </button>\n            <button class="btn btn-primary" data-action="confirm">\n              ${e.confirmText||"确认"}\n            </button>\n          </div>\n        </div>\n      `;a.addEventListener("click",(e=>{const s=e.target.dataset.action;s&&(a.remove(),t("confirm"===s))})),document.body.appendChild(a)}))}showProgress(e={}){const t=document.createElement("div");t.className="progress-bar",t.innerHTML='\n      <div class="progress-track">\n        <div class="progress-fill"></div>\n      </div>\n      <div class="progress-text">0%</div>\n    ';const a=t.querySelector(".progress-fill"),s=t.querySelector(".progress-text");let i=0;const n=e.progress||0,o=e.duration||300,r=performance.now(),l=e=>{const t=e-r,c=Math.min(t/o,1);i=n*c,a.style.width=`${i}%`,s.textContent=`${Math.round(i)}%`,c<1&&requestAnimationFrame(l)};return requestAnimationFrame(l),t}};new class{constructor(){this.container=document.querySelector(".language-switcher"),this.buttons=new Map,this.init()}init(){this.container.querySelectorAll("button[data-lang]").forEach((e=>{const t=e.getAttribute("data-lang");this.buttons.set(t,e),e.addEventListener("click",(()=>this.switchLanguage(t)))})),this.updateButtonStates(d.currentLanguage),d.addObserver(this.updateButtonStates.bind(this)),this.setupKeyboardNavigation(),void 0!==window.languagechange&&window.addEventListener("languagechange",(()=>{const e=d.getSystemLanguage();localStorage.getItem("preferredLanguage")||this.switchLanguage(e,!0)}))}async switchLanguage(e,t=!1){const a=this.buttons.get(e);if(a){this.buttons.forEach((e=>e.disabled=!0));try{a.classList.add("is-loading"),await d.setLanguage(e),this.updateButtonStates(e),t||h.showToast(d.translate("messages.languageChanged","语言已切换"),"success")}catch(s){console.error("Failed to switch language:",s),h.showToast(d.translate("messages.languageChangeFailed","语言切换失败"),"error")}finally{this.buttons.forEach((e=>{e.disabled=!1,e.classList.remove("is-loading")}))}}else console.error("Language button not found:",e)}updateButtonStates(e){this.buttons.forEach(((t,a)=>{const s=a===e;t.setAttribute("aria-pressed",s.toString()),t.classList.toggle("active",s);try{const e=s?"currentLanguage":"switchTo",i=d.translate(`languages.${a}`,a),n=d.translate(`accessibility.${e}`,"currentLanguage"===e?"当前语言":"切换到");n&&t.setAttribute("aria-label",`${n}: ${i}`);const o=d.translate(`languages.${a}`,a.toUpperCase());t.textContent=o}catch(i){console.warn("Failed to update button text:",i);const e=t.getAttribute("data-i18n-default");e&&(t.textContent=e)}}))}setupKeyboardNavigation(){const e=Array.from(this.buttons.values());let t=-1;this.container.addEventListener("keydown",(a=>{switch(a.key){case"ArrowRight":case"ArrowDown":a.preventDefault(),t=(t+1)%e.length,e[t].focus();break;case"ArrowLeft":case"ArrowUp":a.preventDefault(),t=(t-1+e.length)%e.length,e[t].focus();break;case"Home":a.preventDefault(),t=0,e[t].focus();break;case"End":a.preventDefault(),t=e.length-1,e[t].focus()}}))}};window.adManager=new class{constructor(){this.platforms={google:!1,baidu:!1,alimama:!1,jd:!1,pdd:!1},this.stats={impressions:{},clicks:{},revenue:{}},this.retryAttempts=3,this.retryDelay=1e3,this.init()}init(){this.loadSDKs(),this.initTracking(),this.loadStats(),this.setupErrorHandling()}setupErrorHandling(){window.addEventListener("error",(e=>{e.message.includes("adsbygoogle")&&(console.error("AdSense error:",e),this.handleAdError("google",e))}))}async loadSDKs(){try{await this.loadScript({src:"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4468142418161903",async:!0,crossOrigin:"anonymous"}),this.platforms.google=!0}catch(e){console.error("Failed to load Google AdSense:",e),this.handleAdError("google",e)}}loadScript(e){return new Promise(((t,a)=>{const s=document.createElement("script");s.async=e.async,s.src=e.src,e.crossOrigin&&(s.crossOrigin=e.crossOrigin),s.onload=()=>t(),s.onerror=e=>a(e),document.head.appendChild(s)}))}initTracking(){["google","baidu","alimama","jd","pdd"].forEach((e=>{this.stats.impressions[e]=0,this.stats.clicks[e]=0,this.stats.revenue[e]=0}))}handleAdError(e,t){console.error(`${e} ad error:`,t),this.sendTrackingData({type:"error",platform:e,error:t.message,timestamp:(new Date).getTime()}),t.message.includes("configuration")&&(this.platforms[e]=!1)}trackImpression(e,t){this.platforms[e]&&(this.stats.impressions[e]++,this.saveStats(),this.sendTrackingData({type:"impression",platform:e,position:t,timestamp:(new Date).getTime()}))}trackClick(e,t){this.platforms[e]&&(this.stats.clicks[e]++,this.saveStats(),this.sendTrackingData({type:"click",platform:e,position:t,timestamp:(new Date).getTime()}))}async sendTrackingData(e){try{const t=await fetch("/api/track",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,url:window.location.href,userAgent:navigator.userAgent})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`)}catch(t){console.error("Failed to send tracking data:",t),this.queueFailedTrackingData(e)}}queueFailedTrackingData(e){const t=JSON.parse(localStorage.getItem("adTrackingQueue")||"[]");t.push(e),localStorage.setItem("adTrackingQueue",JSON.stringify(t))}retryFailedTracking(){const e=JSON.parse(localStorage.getItem("adTrackingQueue")||"[]");if(0===e.length)return;const t=e.shift();this.sendTrackingData(t).then((()=>{localStorage.setItem("adTrackingQueue",JSON.stringify(e))})).catch((()=>{e.push(t),localStorage.setItem("adTrackingQueue",JSON.stringify(e))}))}saveStats(){localStorage.setItem("adStats",JSON.stringify(this.stats))}loadStats(){const e=localStorage.getItem("adStats");e&&(this.stats=JSON.parse(e))}async createGoogleAd(e,t="auto"){if(!this.platforms.google)return void console.warn("Google AdSense is not available");const a=document.createElement("ins");a.className="adsbygoogle",a.style.display="block",a.dataset.adClient="ca-pub-4468142418161903",a.dataset.adFormat=t,a.dataset.fullWidthResponsive="true",e.appendChild(a);try{(adsbygoogle=window.adsbygoogle||[]).push({}),this.trackImpression("google",e.id)}catch(s){this.handleAdError("google",s),this.tryAlternativeAd(e)}}tryAlternativeAd(e){this.platforms.baidu&&this.createBaiduAd(e)}createAd(e,t,a={}){if(this.platforms[e])if("google"===e)this.createGoogleAd(t,a.format);else console.error("Unknown platform:",e);else console.warn(`${e} ads are not available`)}measureAdPerformance(e,t){const a=performance.now(),s=new PerformanceObserver((a=>{a.getEntries().forEach((a=>{if(a.name.includes("adsbygoogle")){const s=a.duration;this.sendTrackingData({type:"performance",platform:e,containerId:t,loadTime:s,timestamp:(new Date).getTime()})}}))}));return s.observe({entryTypes:["resource"]}),()=>{s.disconnect();return performance.now()-a}}};const g=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{s as C,l as D,c as I,t as _,u as a,g as b,r as i,h as u};
//# sourceMappingURL=ad-manager-nkcXdfJJ.js.map
