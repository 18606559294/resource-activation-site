const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/app-BwBtuLTk.js","assets/ad-manager-nkcXdfJJ.js","assets/ad-manager-BaVhgcWV.css","assets/deepseek-integration-DDBlkned.js"])))=>i.map(i=>d[i]);
import{D as e,i as t,_ as o}from"./ad-manager-nkcXdfJJ.js";function s(e="加载中..."){let t=document.querySelector(".loading-indicator");t||(t=function(){const e=document.createElement("div");return e.className="loading-indicator",e.innerHTML='\n        <div class="loading-spinner"></div>\n        <div class="loading-message"></div>\n    ',document.body.appendChild(e),e}()),t.querySelector(".loading-message").textContent=e,t.style.display="flex"}function n(){const e=document.querySelector(".loading-indicator");e&&(e.style.display="none")}function i(e){let t=document.querySelector(".error-message");t&&t.remove(),t=function(e){const{title:t,message:o,actionText:s,actionHandler:n}=e,i=document.createElement("div");i.className="error-message",i.innerHTML=`\n        <div class="error-content">\n            <h3>${t}</h3>\n            <p>${o}</p>\n            ${s?`<button class="error-action">${s}</button>`:""}\n        </div>\n    `,s&&n&&i.querySelector(".error-action").addEventListener("click",n);return document.body.appendChild(i),i}(e),t.style.display="flex"}function a(){window.deepseekChatWidget||setTimeout((()=>{try{window.deepseekChatWidget=new e,console.log(t.t("deepseek.logs.initialized","DeepSeek客服聊天窗口已加载"))}catch(o){console.error(t.t("deepseek.logs.initFailed","初始化DeepSeek客服聊天窗口失败:"),o)}}),1e3)}document.addEventListener("DOMContentLoaded",a);const r=new class{constructor(){this.loadedResources=new Set,this.loadingPromises=new Map,this.maxConcurrent=5,this.loadingCount=0,this.queue=[]}_addToQueue(e,t){return this.queue.push({resource:e,options:t}),new Promise(((t,o)=>{const s=this._processQueue.bind(this);this._processQueue=async()=>{await s(),this.loadedResources.has(e.url)&&t()},this._processQueue().catch(o)}))}async _processQueue(){if(this.loadingCount>=this.maxConcurrent||0===this.queue.length)return;const{resource:e,options:t}=this.queue.shift();this.loadingCount++;try{await this._loadResource(e,t)}finally{this.loadingCount--,this._processQueue()}}async _loadResource(e,t){const{timeout:o=1e4,retries:s=3}=t;for(let i=0;i<s;i++)try{const t=new AbortController,s=setTimeout((()=>t.abort()),o),n=await fetch(e.url,{signal:t.signal});if(clearTimeout(s),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const i=await n.blob(),a=URL.createObjectURL(i);return this.loadedResources.add(e.url),a}catch(n){if(i===s-1)throw n;await new Promise((e=>setTimeout(e,1e3*Math.pow(2,i))))}}async preload(e,t={}){const{onProgress:o=null}=t;let s=0;const n=e.length;try{const i=e.map((e=>new Promise(((i,a)=>{if(this.loadedResources.has(e.url))return s++,o&&o(s,n),void i();if(this.loadingPromises.has(e.url))return void this.loadingPromises.get(e.url).then((()=>{s++,o&&o(s,n),i()})).catch(a);const r=this._addToQueue(e,t).then((()=>{s++,o&&o(s,n)}));this.loadingPromises.set(e.url,r),r.then(i).catch(a).finally((()=>{this.loadingPromises.delete(e.url)}))}))));await Promise.all(i)}catch(i){throw console.error("Resource preloading failed:",i),i}}cleanup(){this.loadedResources.clear(),this.loadingPromises.clear(),this.queue=[]}},c=[{path:"./src/js/app.js",type:"module"},{path:"./src/js/animations.js",type:"module"},{path:"./src/js/theme-manager.js",type:"module"},{path:"./src/js/components.js",type:"module"},{path:"./src/js/tools-manager.js",type:"module"},{path:"./src/i18n.js",type:"module"}];async function d(){try{s("正在初始化应用..."),await r.preload(c,{priority:"high",timeout:15e3,retries:3,onProgress:(e,t)=>{s(`正在加载应用资源...(${Math.round(e/t*100)}%)`)}}),document.body.style.visibility="visible";const{default:e}=await o((async()=>{const{default:e}=await import("./app-BwBtuLTk.js");return{default:e}}),__vite__mapDeps([0,1,2,3]));e.initialized||await e.init(),a(),document.documentElement.removeAttribute("data-i18n-loading"),n(),console.log("应用初始化完成")}catch(e){console.error("应用初始化失败:",e),document.body.style.visibility="visible",document.documentElement.removeAttribute("data-i18n-loading"),n()}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",d):d();export{i as a,n as h,s};
//# sourceMappingURL=main-Ec0-SUeq.js.map
